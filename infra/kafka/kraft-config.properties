# KRaft Mode Configuration for SIEM Kafka Cluster
# Designed for 100K EPS throughput

############################# Server Basics #############################

# Node ID - unique per broker
node.id=1

# Process roles: broker, controller, or both
process.roles=broker,controller

# Controller quorum voters
controller.quorum.voters=1@kafka-1:9093,2@kafka-2:9093,3@kafka-3:9093

############################# Socket Server Settings #############################

# Listeners
listeners=PLAINTEXT://:9092,CONTROLLER://:9093
inter.broker.listener.name=PLAINTEXT
controller.listener.names=CONTROLLER
listener.security.protocol.map=CONTROLLER:PLAINTEXT,PLAINTEXT:PLAINTEXT

# Advertised listeners (adjust per host)
advertised.listeners=PLAINTEXT://kafka-1:9092

# Network threads for handling requests
num.network.threads=8

# I/O threads for disk operations
num.io.threads=16

# Socket send/receive buffer sizes (1MB each)
socket.send.buffer.bytes=1048576
socket.receive.buffer.bytes=1048576

# Maximum request size (100MB)
socket.request.max.bytes=104857600

############################# Log Basics #############################

# Log directories
log.dirs=/var/lib/kafka/data

# Default partitions for auto-created topics (disabled in production)
num.partitions=32
default.replication.factor=3
min.insync.replicas=2

# Disable auto topic creation
auto.create.topics.enable=false

############################# Log Retention #############################

# Retention time (7 days)
log.retention.hours=168

# Retention size per partition (100GB)
log.retention.bytes=107374182400

# Segment size (1GB)
log.segment.bytes=1073741824

# Check interval for retention
log.retention.check.interval.ms=300000

# Delete retention delay
log.segment.delete.delay.ms=60000

############################# Log Flush Policy #############################

# Flush after this many messages
log.flush.interval.messages=10000

# Flush every 1 second
log.flush.interval.ms=1000

############################# Compression #############################

# Use LZ4 for better compression/speed ratio
compression.type=lz4

# Message max size (10MB)
message.max.bytes=10485760

############################# Replication #############################

# Max bytes to fetch for replica sync
replica.fetch.max.bytes=10485760

# Replica lag settings
replica.lag.time.max.ms=30000

# Unclean leader election (disabled for data safety)
unclean.leader.election.enable=false

############################# Group Coordinator Settings #############################

# Offsets topic settings
offsets.topic.replication.factor=3
offsets.topic.num.partitions=50
offsets.retention.minutes=10080

# Group rebalance delay
group.initial.rebalance.delay.ms=3000
group.min.session.timeout.ms=6000
group.max.session.timeout.ms=1800000

############################# Transaction Settings #############################

transaction.state.log.replication.factor=3
transaction.state.log.min.isr=2
transaction.state.log.num.partitions=50

############################# Quotas #############################

# Default quota (unlimited)
quota.producer.default=9223372036854775807
quota.consumer.default=9223372036854775807

############################# Metrics #############################

# Metrics reporters
metric.reporters=

# JMX settings
jmx.port=9999

############################# ZK Migration (if needed) #############################

# Enable migration mode if migrating from ZK
# zookeeper.metadata.migration.enable=false
